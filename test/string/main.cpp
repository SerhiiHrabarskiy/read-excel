
/*
	SPDX-FileCopyrightText: 2011-2024 Igor Mironchik <igor.mironchik@gmail.com>
	SPDX-License-Identifier: MIT
*/

// Excel include.
#include <read-excel/string.hpp>

// C++ include.
#include <vector>

// unit test helper.
#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN
#include <test/doctest/doctest.h>
#include <test/helper/helper.hpp>
#include <test/stream/stream.hpp>


const auto data = make_data(
	0x0Fu, 0x00u, 0x08u, 0x02u, 0x00u, 0x74u, 0x68u, 0x69u,
	0x73u, 0x20u, 0x69u, 0x73u, 0x20u, 0x72u, 0x65u, 0x64u,
	0x20u, 0x69u, 0x6Eu, 0x6Bu, 0x08u, 0x00u, 0x06u, 0x00u,
	0x0Bu, 0x00u, 0x05u, 0x00u,

	0x0Fu, 0x00u, 0x00u, 0x74u, 0x68u, 0x69u, 0x73u, 0x20u,
	0x69u, 0x73u, 0x20u, 0x72u, 0x65u, 0x64u, 0x20u, 0x69u,
	0x6Eu, 0x6Bu,

	0x0Fu, 0x00u, 0x01u, 0x74u, 0x00u, 0x68u, 0x00u, 0x69u,
	0x00u, 0x73u, 0x00u, 0x20u, 0x00u, 0x69u, 0x00u, 0x73u,
	0x00u, 0x20u, 0x00u, 0x72u, 0x00u, 0x65u, 0x00u, 0x64u,
	0x00u, 0x20u, 0x00u, 0x69u, 0x00u, 0x6Eu, 0x00u, 0x6Bu,
	0x00u,

	0x0Fu, 0x00u, 0x04u, 0x04u, 0x00u, 0x00u, 0x00u, 0x74u,
	0x68u, 0x69u, 0x73u, 0x20u, 0x69u, 0x73u, 0x20u, 0x72u,
	0x65u, 0x64u, 0x20u, 0x69u, 0x6Eu, 0x6Bu, 0x00u, 0x00u,
	0x00u, 0x00u,

	0x0Fu, 0x00u, 0x0Cu, 0x02u, 0x00u, 0x04u, 0x00u, 0x00u,
	0x00u, 0x74u, 0x68u, 0x69u, 0x73u, 0x20u, 0x69u, 0x73u,
	0x20u, 0x72u, 0x65u, 0x64u, 0x20u, 0x69u, 0x6Eu, 0x6Bu,
	0x08u, 0x00u, 0x06u, 0x00u, 0x0Bu, 0x00u, 0x05u, 0x00u,
	0x00u, 0x00u, 0x00u, 0x00u,

	0x0Fu, 0x00u, 0x00u, 0x74u, 0x68u, 0x69u, 0x73u, 0x20u,
	0x69u, 0x73u, 0x20u, 0x72u, 0x65u, 0x64u, 0x20u, 0x69u,
	0x6Eu, 0x6Bu
); // data


TEST_CASE( "test_string" )
{
	std::vector< int32_t > borders;
	std::wstring str;

	TestStream stream( &data[ 0 ], 159 );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );

	str = Excel::loadString( stream, borders );

	REQUIRE( str == L"this is red ink" );
}
